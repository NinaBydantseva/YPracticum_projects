## Проект:

Создание витрины для расчётов с курьерами

## Задача:

Необходимо построить витрину, содержащую информацию о выплатах курьерам.     
Для этого нужно создать многослойный DWH, реализовать ETL-процессы, которые будут преобразовывать и перемещать данные от источников до конечных слоёв данных.

## Решение:
- Используемые библиотеки Python:
  - requests,
  - json,
  - psycopg2,
  - logging,
  - datetime,
  - airflow.

## Ход решения:

- Создаем функции:
  - загрузка данных о курьерах в stg-слой - upload_couriers, также сохраняем максимальный идентификатор курьера для отсечения уже загруженных данных,
  - загрузка данных о ресторанах в stg-слой - upload_restaurants, также сохраняем максимальный идентификатор ресторана для отсечения уже загруженных данных,
  - загрузка данных о доставках в stg-слой - upload_deliveries, также сохраняем максимальный идентификатор доставки для отсечения уже загруженных данных,
  - загрузка данных о ресторанах из stg-слоя в dds-слой - load_restaurants,
  - загрузка данных о курьерах из stg-слоя в dds-слой - load_couriers,
  - загрузка данных о заказах из stg-слоя в dds-слой - load_orders,
  - загрузка данных о доставках из stg-слоя в dds-слой - load_deliveries,
  - заполнение таблицы фактов о курьерах и их доставках - load_fct_courier_delivery,
  - заполнение витрины данными - load_cdm_m_courier_ledger,
- формирование пайплайна DAG:
  - t_upload_couriers, t_upload_restaurants, t_upload_deliveries >> t_load_restaurants, t_load_couriers, t_load_orders, t_load_deliveries >> t_load_fct_courier_delivery >> t_load_cdm_m_courier_ledger
