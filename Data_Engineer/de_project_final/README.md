## Проект:

Выпускной проект: разработка ETL-процесса для учёта транзакционной активности клиентов в единой валюте

## Задача:

Собрать данные по транзакционной активности пользователей и настроить обновление таблицы с курсом валют, чтобы понять, как выглядит динамика оборота всей компании и что приводит к его изменениям. 
Также необходимо построить дашборд.
Исходные данные размещены в S3, конечные данные должны быть рамещены в Vertica. Дашборд реализовать в Metabase.

## Решение:
- Используемые библиотеки Python:
  - contextlib,
  - hashlib,
  - json,
  - typing,
  - datetime,
  - psycopg2,
  - airflow,
  - pandas,
  - pendulum,
  - vertica_python.

### Ход решения:
- созданы функции для формирования слоя stg:
  - функция формирования дат в заданном диапазоне - date_array,
  - функция получения данных о транзакциях из Postgre - get_transactions,
  - функция получения данных о валютах транзакций из Postgre - get_currencies,
  - функция загрузки данных в слой stg в Vertica - load_dataset_from_ps_to_vertica,
  - собран пайплайн DAG для ежедневного обновления слоя stg - prj_final_dag_load_STG [start >> [load_transactions, load_currencies] >> end],
- созданы функции для формирования слоя cdm:
  - функция получения данных о метриках из Vertica - get_metrics,
  - функция загрузки данных в слой cdm в Vertica - load_dataset_to_mart,
  - собран пайплайн DAG для ежедневного обновления слоя cdm - prj_final_dag_load_CDM [start >> load_global_metrics >> end],
- создан дашборд в Metabase.
