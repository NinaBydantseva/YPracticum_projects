## Проект:

Оптимизация производственных расходов металлургического комбината

## Задача:
 
Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава.     
Необходимо построить модель, которая будет предсказывать температуру сплава.
Заказчик хочет использовать разработанную модель для имитации технологического процесса. Ниже расскажем о деталях этого процесса. Их важно знать, прежде чем генерировать новые признаки.    

**Описание этапа обработки:**    
Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша.    

Из сплава выводится сера (этот процесс — десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (от англ. tribe — «масса»).    

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.
Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (от англ. slab — «плита»).

## Решение:
- Используемые библиотеки Python:
  - pandas,
  - seaborn,
  - numpy,
  - phik,
  - matplotlib.pyplot,
  - sklearn.

### Ход решения:

В этом проекте перед нами стояла задача построить модель машинного обучения, которая будет рассчитывать итоговую температуру выплавки стали (с целью экономии электроэнергии), для этого мы:    
- исследовали полученные от заказчика исходных данные с результатами фиксации показателей процесса выплавки стали;
- провели исследовательский анализ исходных данных:
    - data_arc_new — данные об электродах;
    - data_bulk_new — данные о подаче сыпучих материалов (объём);
    - data_bulk_time_new — данные о подаче сыпучих материалов (время);
    - data_gas_new — данные о продувке сплава газом;
    - data_temp_new — результаты измерения температуры;
    - data_wire_new — данные о проволочных материалах (объём);
    - data_wire_time_new — данные о проволочных материалах (время),
    в которых обнаружили некорректные и пропущенные значения;
- поскольку в исходных данных были наборы, которые содержали несколько записей о процессах внутри одной партии, то мы агрегировали показатели в этих наборах и рассчитали новые показатели, которые могли бы нам пригодиться;
- перед объединением наборов в один мы удалили некорректные данные (отрицательную мощность, одиночные замеры);
- объединили наборы в один по номеру партии (key);
- провели исследование итогового набора и построили матрицу корреляции для определения признаков, которые влияют на целевой признак;
- избавились от мультиколлинеарности путем удаления признаков, имеющих коэффициент корелляции>0.9;
- повторно сформировали матрицу корреляции и отобразили ее на тепловой карте;
- удалили из данных аномальные значения;
- выбрали модели:
    - LinearRegression,
    - DecisionTreeRegressor,
    - Ridge,
    - XGBRegressor;
- собрали пайплайн для поиска лучшей модели с помощью метода RandomizedSearchCV;
- определили лучшую модель по метрике MAE, ей оказалась модель XGBRegressor со следующими гиперпараметрами:
    - learning_rate=0.21,
    - max_depth=2,
    - n_estimators=100,
    - n_jobs=8,
    - StandardScaler(),
    - random_state=130125;     
  с MAE=6.19, полученной на кросс-валидации;
- протестировали лучшую модель и определили метрики MAE=5.97 и R2=0.5;
- провели дамми-тест моделью DummyClassifier, который показал метрики MAE=8.11 и R2=0;
- провели исследование важности признаков в лучшей модели: высокий коэффициент получился для материалов b14 и w1, также стоит учитывать b3, b15, w2 и показатели мощности. 

## Вывод:

Мы построили модель машинного обучения, которая позволила нам выявить необходимые закономерности технологического процесса. Благодаря этому мы предлагаем бизнесу влиять на затраты электроэнергии через определение показателей конечной температуры процесса выплавки при известных объемах сыпучих и проволочных материалов b14 и w1. Также рекомендуется обратить внимание на дополнительные 4 показателя: объемы сыпучих и проволочных материалов b3, b15, w2 и показатели мощности.
